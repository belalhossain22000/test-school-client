(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4735],{968:(e,t,r)=>{"use strict";r.d(t,{b:()=>l});var s=r(2115),a=r(3655),n=r(5155),i=s.forwardRef((e,t)=>(0,n.jsx)(a.sG.label,{...e,ref:t,onMouseDown:t=>{var r;t.target.closest("button, input, select, textarea")||(null===(r=e.onMouseDown)||void 0===r||r.call(e,t),!t.defaultPrevented&&t.detail>1&&t.preventDefault())}}));i.displayName="Label";var l=i},1164:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>x});var s=r(5155),a=r(2115),n=r(5695),i=r(6874),l=r.n(i),o=r(7168),d=r(9852),u=r(2714),c=r(8482),f=r(9026),m=r(7550),g=r(8883),v=r(4782),h=r(6671);function p(){let e=(0,n.useRouter)(),t=(0,n.useSearchParams)().get("email")||"",[r,i]=(0,a.useState)(["","","","","",""]),[p,x]=(0,a.useState)(!1),[y,b]=(0,a.useState)(""),[w,N]=(0,a.useState)(0),[j,{isLoading:k}]=(0,v.x8)(),[T,{isLoading:P}]=(0,v.fQ)();(0,a.useEffect)(()=>{if(w<=0)return;let e=setInterval(()=>{N(e=>e>0?e-1:0)},1e3);return()=>clearInterval(e)},[w]);let A=(e,t)=>{if(t.length>1)return;let s=[...r];if(s[e]=t,i(s),t&&e<5){let t=document.getElementById("otp-".concat(e+1));null==t||t.focus()}},R=(e,t)=>{if("Backspace"===t.key&&!r[e]&&e>0){let t=document.getElementById("otp-".concat(e-1));null==t||t.focus()}},S=async s=>{s.preventDefault(),x(!0),b("");let a=r.join("");if(6!==a.length){b("Please enter all 6 digits"),x(!1);return}try{let r=await j({email:t,otp:parseInt(a)}).unwrap();r.success?(h.o.success("OTP verified successfully!"),setTimeout(()=>{e.push("/auth/login?verified=true")},1e3)):b(r.message||"Invalid OTP. Please try again.")}catch(e){var n;b((null==e?void 0:null===(n=e.data)||void 0===n?void 0:n.message)||e.message||"OTP verification failed.")}finally{x(!1)}},_=async()=>{N(60),b("");try{let e=await T({email:t}).unwrap();h.o.success(e.message||"OTP has been resent to your email")}catch(r){var e;let t=(null==r?void 0:null===(e=r.data)||void 0===e?void 0:e.message)||r.message||"Failed to resend OTP. Please try again.";b(t),h.o.error(t)}};return(0,s.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center p-4",children:(0,s.jsxs)("div",{className:"w-full max-w-md",children:[(0,s.jsx)("div",{className:"mb-6",children:(0,s.jsx)(o.$,{variant:"ghost",asChild:!0,className:"mb-4",children:(0,s.jsxs)(l(),{href:"/auth/register",children:[(0,s.jsx)(m.A,{className:"w-4 h-4 mr-2"}),"Back to Register"]})})}),(0,s.jsxs)(c.Zp,{children:[(0,s.jsxs)(c.aR,{className:"text-center",children:[(0,s.jsx)("div",{className:"w-12 h-12 bg-blue-600 rounded-lg flex items-center justify-center mx-auto mb-4",children:(0,s.jsx)(g.A,{className:"w-6 h-6 text-white"})}),(0,s.jsx)(c.ZB,{className:"text-2xl",children:"Verify Your Email"}),(0,s.jsxs)(c.BT,{children:["We've sent a 6-digit code to",(0,s.jsx)("br",{}),(0,s.jsx)("strong",{children:t})]})]}),(0,s.jsxs)(c.Wu,{children:[(0,s.jsxs)("form",{onSubmit:S,className:"space-y-6",children:[y&&(0,s.jsx)(f.Fc,{variant:"destructive",children:(0,s.jsx)(f.TN,{children:y})}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(u.J,{children:"Enter verification code"}),(0,s.jsx)("div",{className:"flex gap-2 justify-center",children:r.map((e,t)=>(0,s.jsx)(d.p,{id:"otp-".concat(t),type:"text",inputMode:"numeric",maxLength:1,value:e,onChange:e=>A(t,e.target.value),onKeyDown:e=>R(t,e),className:"w-12 h-12 text-center text-lg font-semibold"},t))})]}),(0,s.jsx)(o.$,{type:"submit",className:"w-full",disabled:p,children:p?"Verifying...":"Verify Email"})]}),(0,s.jsxs)("div",{className:"mt-6 text-center",children:[(0,s.jsx)("p",{className:"text-sm text-gray-600 mb-2",children:"Didn't receive the code?"}),(0,s.jsx)(o.$,{variant:"ghost",onClick:_,disabled:w>0,className:"text-blue-600 hover:text-blue-700",children:w>0?"Resend in ".concat(w,"s"):"Resend Code"})]})]})]})]})})}function x(){return(0,s.jsx)(a.Suspense,{fallback:(0,s.jsx)("div",{children:"Loading..."}),children:(0,s.jsx)(p,{})})}},1913:(e,t,r)=>{"use strict";r.d(t,{Ay:()=>c,gV:()=>o,ri:()=>u,wz:()=>l});var s=r(5710),a=r(7383),n=r(9159);let i=(0,s.Z0)({name:"auth",initialState:{token:null,refresh_token:null},reducers:{setUser:(e,t)=>{e.token=t.payload.token,a.A.set("token",t.payload.token)},getUser:(e,t)=>{e.token=t.payload.token,a.A.set("token",t.payload.token)},setRefreshToken:(e,t)=>{e.refresh_token=t.payload.refresh_token},logout:e=>{e.token=null,e.refresh_token=null,a.A.remove("token"),localStorage.removeItem("token")}}}),l=e=>{let t=e.auth.token||a.A.get("token");if(!t)return null;try{return(0,n.s)(t)}catch(e){return null}},{setUser:o,setRefreshToken:d,logout:u}=i.actions,c=i.reducer},2714:(e,t,r)=>{"use strict";r.d(t,{J:()=>d});var s=r(5155),a=r(2115),n=r(968),i=r(2085),l=r(3999);let o=(0,i.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),d=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)(n.b,{ref:t,className:(0,l.cn)(o(),r),...a})});d.displayName=n.b.displayName},3419:(e,t,r)=>{"use strict";r.d(t,{q:()=>o});var s=r(4317),a=r(404),n=r(1913);let i="https://test-school-server-three.vercel.app/api/v1";if(!i)throw Error("Environment variable NEXT_PUBLIC_BASE_URL is not set");let l=async(e,t,r)=>{let a=(0,s.cw)({baseUrl:i,prepareHeaders:(e,t)=>{var r;let{getState:s}=t,a=null===(r=s().auth)||void 0===r?void 0:r.token;return a&&e.set("Authorization","".concat(a)),e}}),l=await a(e,t,r);return l.error&&(401===l.error.status||403===l.error.status)&&(t.dispatch((0,n.ri)()),window.location.href="/auth/login"),l},o=(0,a.xP)({reducerPath:"baseApi",baseQuery:l,tagTypes:["User","Assignment","AssignmentSubmission","Notification"],endpoints:e=>({})})},3999:(e,t,r)=>{"use strict";r.d(t,{cn:()=>n});var s=r(2596),a=r(9688);function n(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,a.QP)((0,s.$)(t))}},4782:(e,t,r)=>{"use strict";r.d(t,{_L:()=>s,fQ:()=>l,ge:()=>a,nd:()=>i,x8:()=>o});let{useLoginMutation:s,useRegisterMutation:a,useSocialAuthMutation:n,useForgotPasswordMutation:i,useResendOtpMutation:l,useVerifyOtpMutation:o,useResetPasswordMutation:d,useChangePasswordMutation:u,useGetMeQuery:c,useUpdateUserMutation:f}=r(3419).q.injectEndpoints({endpoints:e=>({login:e.mutation({query:e=>({url:"/auth/login",method:"POST",body:e}),invalidatesTags:["User"]}),register:e.mutation({query:e=>({url:"/users/register",method:"POST",body:e}),invalidatesTags:["User"]}),socialAuth:e.mutation({query:e=>({url:"/auth/social-login",method:"POST",body:e}),invalidatesTags:["User"]}),forgotPassword:e.mutation({query:e=>({url:"/auth/forgot-password",method:"POST",body:e}),invalidatesTags:["User"]}),resendOtp:e.mutation({query:e=>({url:"/otp/send",method:"POST",body:e})}),verifyOtp:e.mutation({query:e=>({url:"/otp/verify",method:"POST",body:e})}),resetPassword:e.mutation({query:e=>({url:"/auth/reset-password",method:"POST",body:e})}),changePassword:e.mutation({query:e=>({url:"/auth/change-password",method:"POST",body:e})}),getMe:e.query({query:()=>({url:"/users/me",method:"GET"}),providesTags:["User"]}),updateUser:e.mutation({query:e=>({url:"/users/profile",method:"PUT",body:e}),invalidatesTags:["User"]})})})},7168:(e,t,r)=>{"use strict";r.d(t,{$:()=>d});var s=r(5155),a=r(2115),n=r(9708),i=r(2085),l=r(3999);let o=(0,i.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),d=a.forwardRef((e,t)=>{let{className:r,variant:a,size:i,asChild:d=!1,...u}=e,c=d?n.DX:"button";return(0,s.jsx)(c,{className:(0,l.cn)(o({variant:a,size:i,className:r})),ref:t,...u})});d.displayName="Button"},7550:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(9946).A)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},8482:(e,t,r)=>{"use strict";r.d(t,{BT:()=>d,Wu:()=>u,ZB:()=>o,Zp:()=>i,aR:()=>l});var s=r(5155),a=r(2115),n=r(3999);let i=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("div",{ref:t,className:(0,n.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",r),...a})});i.displayName="Card";let l=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("div",{ref:t,className:(0,n.cn)("flex flex-col space-y-1.5 p-6",r),...a})});l.displayName="CardHeader";let o=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("div",{ref:t,className:(0,n.cn)("text-2xl font-semibold leading-none tracking-tight",r),...a})});o.displayName="CardTitle";let d=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("div",{ref:t,className:(0,n.cn)("text-sm text-muted-foreground",r),...a})});d.displayName="CardDescription";let u=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("div",{ref:t,className:(0,n.cn)("p-6 pt-0",r),...a})});u.displayName="CardContent",a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("div",{ref:t,className:(0,n.cn)("flex items-center p-6 pt-0",r),...a})}).displayName="CardFooter"},8883:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(9946).A)("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]])},9026:(e,t,r)=>{"use strict";r.d(t,{Fc:()=>o,TN:()=>d});var s=r(5155),a=r(2115),n=r(2085),i=r(3999);let l=(0,n.F)("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),o=a.forwardRef((e,t)=>{let{className:r,variant:a,...n}=e;return(0,s.jsx)("div",{ref:t,role:"alert",className:(0,i.cn)(l({variant:a}),r),...n})});o.displayName="Alert",a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("h5",{ref:t,className:(0,i.cn)("mb-1 font-medium leading-none tracking-tight",r),...a})}).displayName="AlertTitle";let d=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("div",{ref:t,className:(0,i.cn)("text-sm [&_p]:leading-relaxed",r),...a})});d.displayName="AlertDescription"},9256:(e,t,r)=>{Promise.resolve().then(r.bind(r,1164))},9852:(e,t,r)=>{"use strict";r.d(t,{p:()=>i});var s=r(5155),a=r(2115),n=r(3999);let i=a.forwardRef((e,t)=>{let{className:r,type:a,...i}=e;return(0,s.jsx)("input",{type:a,className:(0,n.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",r),ref:t,...i})});i.displayName="Input"}},e=>{var t=t=>e(e.s=t);e.O(0,[3817,9417,3056,404,6671,8441,1684,7358],()=>t(9256)),_N_E=e.O()}]);